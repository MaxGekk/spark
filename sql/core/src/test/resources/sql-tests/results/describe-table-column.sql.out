-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TEMPORARY VIEW desc_col_temp_view (key int COMMENT 'column_comment', col struct<x:int, y:string>) USING PARQUET
-- !query schema
struct<>
-- !query output



-- !query
DESC FORMATTED desc_col_temp_view desc_col_temp_view.key
-- !query schema
struct<info_name:string,info_value:string>
-- !query output
col_name	key
data_type	int
comment	column_comment
min	NULL
max	NULL
num_nulls	NULL
distinct_count	NULL
avg_col_len	NULL
max_col_len	NULL
histogram	NULL


-- !query
DESC desc_col_temp_view col.x
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
DESC TABLE COLUMN does not support nested column: col.x


-- !query
CREATE TABLE desc_complex_col_table (`a.b` int, col struct<x:int, y:string>) USING PARQUET
-- !query schema
struct<>
-- !query output



-- !query
DESC FORMATTED desc_complex_col_table `a.b`
-- !query schema
struct<info_name:string,info_value:string>
-- !query output
col_name	a.b
data_type	int
comment	NULL
min	NULL
max	NULL
num_nulls	NULL
distinct_count	NULL
avg_col_len	NULL
max_col_len	NULL
histogram	NULL


-- !query
DESC FORMATTED desc_complex_col_table col
-- !query schema
struct<info_name:string,info_value:string>
-- !query output
col_name	col
data_type	struct<x:int,y:string>
comment	NULL
min	NULL
max	NULL
num_nulls	NULL
distinct_count	NULL
avg_col_len	NULL
max_col_len	NULL
histogram	NULL


-- !query
DESC FORMATTED desc_complex_col_table col.x
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
DESC TABLE COLUMN does not support nested column: col.x


-- !query
SET spark.sql.statistics.histogram.enabled=true
-- !query schema
struct<key:string,value:string>
-- !query output
spark.sql.statistics.histogram.enabled	true


-- !query
SET spark.sql.statistics.histogram.numBins=2
-- !query schema
struct<key:string,value:string>
-- !query output
spark.sql.statistics.histogram.numBins	2


-- !query
INSERT INTO desc_col_table values 1, 2, 3, 4
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Table not found: desc_col_table; line 1 pos 12


-- !query
ANALYZE TABLE desc_col_table COMPUTE STATISTICS FOR COLUMNS key
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Table or view not found: desc_col_table; line 1 pos 14


-- !query
DESC EXTENDED desc_col_table key
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Table or view not found: desc_col_table; line 1 pos 14


-- !query
DROP VIEW desc_col_temp_view
-- !query schema
struct<>
-- !query output



-- !query
DROP TABLE desc_col_table
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
Table or view not found: desc_col_table; line 1 pos 11


-- !query
DROP TABLE desc_complex_col_table
-- !query schema
struct<>
-- !query output



-- !query
CREATE TABLE customer(CName STRING) USING PARQUET
-- !query schema
struct<>
-- !query output



-- !query
INSERT INTO customer VALUES('Maria')
-- !query schema
struct<>
-- !query output



-- !query
ANALYZE TABLE customer COMPUTE STATISTICS FOR COLUMNS cname
-- !query schema
struct<>
-- !query output



-- !query
DESC EXTENDED customer cname
-- !query schema
struct<info_name:string,info_value:string>
-- !query output
col_name	cname
data_type	string
comment	NULL
min	NULL
max	NULL
num_nulls	0
distinct_count	1
avg_col_len	5
max_col_len	5
histogram	NULL


-- !query
DROP TABLE customer
-- !query schema
struct<>
-- !query output

