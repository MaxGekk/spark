-- Automatically generated by SQLQueryTestSuite
-- !query
CREATE TEMPORARY VIEW t AS SELECT 1
-- !query schema
struct<>
-- !query output



-- !query
SELECT IF(true, cast(1 as tinyint), cast(2 as tinyint)) FROM t
-- !query schema
struct<IF(true, cast(1 as tinyint), cast(2 as tinyint)):tinyint>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as tinyint), cast(2 as smallint)) FROM t
-- !query schema
struct<IF(true, cast(1 as tinyint), cast(2 as smallint)):smallint>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as tinyint), cast(2 as int)) FROM t
-- !query schema
struct<IF(true, cast(1 as tinyint), cast(2 as int)):int>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as tinyint), cast(2 as bigint)) FROM t
-- !query schema
struct<IF(true, cast(1 as tinyint), cast(2 as bigint)):bigint>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as tinyint), cast(2 as float)) FROM t
-- !query schema
struct<IF(true, cast(1 as tinyint), cast(2 as float)):float>
-- !query output
1.0


-- !query
SELECT IF(true, cast(1 as tinyint), cast(2 as double)) FROM t
-- !query schema
struct<IF(true, cast(1 as tinyint), cast(2 as double)):double>
-- !query output
1.0


-- !query
SELECT IF(true, cast(1 as tinyint), cast(2 as decimal(10, 0))) FROM t
-- !query schema
struct<IF(true, cast(1 as tinyint), cast(2 as decimal(10, 0))):decimal(10,0)>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as tinyint), cast(2 as string)) FROM t
-- !query schema
struct<IF(true, cast(1 as tinyint), cast(2 as string)):string>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as tinyint), cast('2' as binary)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"TINYINT\", \"BINARY\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS TINYINT), CAST(2 AS BINARY)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 56,
    "fragment" : "IF(true, cast(1 as tinyint), cast('2' as binary))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as tinyint), cast(2 as boolean)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"TINYINT\", \"BOOLEAN\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS TINYINT), CAST(2 AS BOOLEAN)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 55,
    "fragment" : "IF(true, cast(1 as tinyint), cast(2 as boolean))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as tinyint), cast('2017-12-11 09:30:00.0' as timestamp)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"TINYINT\", \"TIMESTAMP\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS TINYINT), CAST(2017-12-11 09:30:00.0 AS TIMESTAMP)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 79,
    "fragment" : "IF(true, cast(1 as tinyint), cast('2017-12-11 09:30:00.0' as timestamp))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as tinyint), cast('2017-12-11 09:30:00' as date)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"TINYINT\", \"DATE\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS TINYINT), CAST(2017-12-11 09:30:00 AS DATE)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 72,
    "fragment" : "IF(true, cast(1 as tinyint), cast('2017-12-11 09:30:00' as date))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as smallint), cast(2 as tinyint)) FROM t
-- !query schema
struct<IF(true, cast(1 as smallint), cast(2 as tinyint)):smallint>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as smallint), cast(2 as smallint)) FROM t
-- !query schema
struct<IF(true, cast(1 as smallint), cast(2 as smallint)):smallint>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as smallint), cast(2 as int)) FROM t
-- !query schema
struct<IF(true, cast(1 as smallint), cast(2 as int)):int>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as smallint), cast(2 as bigint)) FROM t
-- !query schema
struct<IF(true, cast(1 as smallint), cast(2 as bigint)):bigint>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as smallint), cast(2 as float)) FROM t
-- !query schema
struct<IF(true, cast(1 as smallint), cast(2 as float)):float>
-- !query output
1.0


-- !query
SELECT IF(true, cast(1 as smallint), cast(2 as double)) FROM t
-- !query schema
struct<IF(true, cast(1 as smallint), cast(2 as double)):double>
-- !query output
1.0


-- !query
SELECT IF(true, cast(1 as smallint), cast(2 as decimal(10, 0))) FROM t
-- !query schema
struct<IF(true, cast(1 as smallint), cast(2 as decimal(10, 0))):decimal(10,0)>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as smallint), cast(2 as string)) FROM t
-- !query schema
struct<IF(true, cast(1 as smallint), cast(2 as string)):string>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as smallint), cast('2' as binary)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"SMALLINT\", \"BINARY\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS SMALLINT), CAST(2 AS BINARY)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 57,
    "fragment" : "IF(true, cast(1 as smallint), cast('2' as binary))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as smallint), cast(2 as boolean)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"SMALLINT\", \"BOOLEAN\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS SMALLINT), CAST(2 AS BOOLEAN)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 56,
    "fragment" : "IF(true, cast(1 as smallint), cast(2 as boolean))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as smallint), cast('2017-12-11 09:30:00.0' as timestamp)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"SMALLINT\", \"TIMESTAMP\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS SMALLINT), CAST(2017-12-11 09:30:00.0 AS TIMESTAMP)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 80,
    "fragment" : "IF(true, cast(1 as smallint), cast('2017-12-11 09:30:00.0' as timestamp))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as smallint), cast('2017-12-11 09:30:00' as date)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"SMALLINT\", \"DATE\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS SMALLINT), CAST(2017-12-11 09:30:00 AS DATE)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 73,
    "fragment" : "IF(true, cast(1 as smallint), cast('2017-12-11 09:30:00' as date))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as int), cast(2 as tinyint)) FROM t
-- !query schema
struct<IF(true, cast(1 as int), cast(2 as tinyint)):int>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as int), cast(2 as smallint)) FROM t
-- !query schema
struct<IF(true, cast(1 as int), cast(2 as smallint)):int>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as int), cast(2 as int)) FROM t
-- !query schema
struct<IF(true, cast(1 as int), cast(2 as int)):int>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as int), cast(2 as bigint)) FROM t
-- !query schema
struct<IF(true, cast(1 as int), cast(2 as bigint)):bigint>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as int), cast(2 as float)) FROM t
-- !query schema
struct<IF(true, cast(1 as int), cast(2 as float)):float>
-- !query output
1.0


-- !query
SELECT IF(true, cast(1 as int), cast(2 as double)) FROM t
-- !query schema
struct<IF(true, cast(1 as int), cast(2 as double)):double>
-- !query output
1.0


-- !query
SELECT IF(true, cast(1 as int), cast(2 as decimal(10, 0))) FROM t
-- !query schema
struct<IF(true, cast(1 as int), cast(2 as decimal(10, 0))):decimal(10,0)>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as int), cast(2 as string)) FROM t
-- !query schema
struct<IF(true, cast(1 as int), cast(2 as string)):string>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as int), cast('2' as binary)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"INT\", \"BINARY\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS INT), CAST(2 AS BINARY)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 52,
    "fragment" : "IF(true, cast(1 as int), cast('2' as binary))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as int), cast(2 as boolean)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"INT\", \"BOOLEAN\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS INT), CAST(2 AS BOOLEAN)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 51,
    "fragment" : "IF(true, cast(1 as int), cast(2 as boolean))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as int), cast('2017-12-11 09:30:00.0' as timestamp)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"INT\", \"TIMESTAMP\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS INT), CAST(2017-12-11 09:30:00.0 AS TIMESTAMP)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 75,
    "fragment" : "IF(true, cast(1 as int), cast('2017-12-11 09:30:00.0' as timestamp))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as int), cast('2017-12-11 09:30:00' as date)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"INT\", \"DATE\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS INT), CAST(2017-12-11 09:30:00 AS DATE)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 68,
    "fragment" : "IF(true, cast(1 as int), cast('2017-12-11 09:30:00' as date))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as bigint), cast(2 as tinyint)) FROM t
-- !query schema
struct<IF(true, cast(1 as bigint), cast(2 as tinyint)):bigint>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as bigint), cast(2 as smallint)) FROM t
-- !query schema
struct<IF(true, cast(1 as bigint), cast(2 as smallint)):bigint>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as bigint), cast(2 as int)) FROM t
-- !query schema
struct<IF(true, cast(1 as bigint), cast(2 as int)):bigint>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as bigint), cast(2 as bigint)) FROM t
-- !query schema
struct<IF(true, cast(1 as bigint), cast(2 as bigint)):bigint>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as bigint), cast(2 as float)) FROM t
-- !query schema
struct<IF(true, cast(1 as bigint), cast(2 as float)):float>
-- !query output
1.0


-- !query
SELECT IF(true, cast(1 as bigint), cast(2 as double)) FROM t
-- !query schema
struct<IF(true, cast(1 as bigint), cast(2 as double)):double>
-- !query output
1.0


-- !query
SELECT IF(true, cast(1 as bigint), cast(2 as decimal(10, 0))) FROM t
-- !query schema
struct<IF(true, cast(1 as bigint), cast(2 as decimal(10, 0))):decimal(20,0)>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as bigint), cast(2 as string)) FROM t
-- !query schema
struct<IF(true, cast(1 as bigint), cast(2 as string)):string>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as bigint), cast('2' as binary)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BIGINT\", \"BINARY\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS BIGINT), CAST(2 AS BINARY)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 55,
    "fragment" : "IF(true, cast(1 as bigint), cast('2' as binary))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as bigint), cast(2 as boolean)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BIGINT\", \"BOOLEAN\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS BIGINT), CAST(2 AS BOOLEAN)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 54,
    "fragment" : "IF(true, cast(1 as bigint), cast(2 as boolean))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as bigint), cast('2017-12-11 09:30:00.0' as timestamp)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BIGINT\", \"TIMESTAMP\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS BIGINT), CAST(2017-12-11 09:30:00.0 AS TIMESTAMP)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 78,
    "fragment" : "IF(true, cast(1 as bigint), cast('2017-12-11 09:30:00.0' as timestamp))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as bigint), cast('2017-12-11 09:30:00' as date)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BIGINT\", \"DATE\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS BIGINT), CAST(2017-12-11 09:30:00 AS DATE)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 71,
    "fragment" : "IF(true, cast(1 as bigint), cast('2017-12-11 09:30:00' as date))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as float), cast(2 as tinyint)) FROM t
-- !query schema
struct<IF(true, cast(1 as float), cast(2 as tinyint)):float>
-- !query output
1.0


-- !query
SELECT IF(true, cast(1 as float), cast(2 as smallint)) FROM t
-- !query schema
struct<IF(true, cast(1 as float), cast(2 as smallint)):float>
-- !query output
1.0


-- !query
SELECT IF(true, cast(1 as float), cast(2 as int)) FROM t
-- !query schema
struct<IF(true, cast(1 as float), cast(2 as int)):float>
-- !query output
1.0


-- !query
SELECT IF(true, cast(1 as float), cast(2 as bigint)) FROM t
-- !query schema
struct<IF(true, cast(1 as float), cast(2 as bigint)):float>
-- !query output
1.0


-- !query
SELECT IF(true, cast(1 as float), cast(2 as float)) FROM t
-- !query schema
struct<IF(true, cast(1 as float), cast(2 as float)):float>
-- !query output
1.0


-- !query
SELECT IF(true, cast(1 as float), cast(2 as double)) FROM t
-- !query schema
struct<IF(true, cast(1 as float), cast(2 as double)):double>
-- !query output
1.0


-- !query
SELECT IF(true, cast(1 as float), cast(2 as decimal(10, 0))) FROM t
-- !query schema
struct<IF(true, cast(1 as float), cast(2 as decimal(10, 0))):double>
-- !query output
1.0


-- !query
SELECT IF(true, cast(1 as float), cast(2 as string)) FROM t
-- !query schema
struct<IF(true, cast(1 as float), cast(2 as string)):string>
-- !query output
1.0


-- !query
SELECT IF(true, cast(1 as float), cast('2' as binary)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"FLOAT\", \"BINARY\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS FLOAT), CAST(2 AS BINARY)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 54,
    "fragment" : "IF(true, cast(1 as float), cast('2' as binary))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as float), cast(2 as boolean)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"FLOAT\", \"BOOLEAN\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS FLOAT), CAST(2 AS BOOLEAN)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 53,
    "fragment" : "IF(true, cast(1 as float), cast(2 as boolean))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as float), cast('2017-12-11 09:30:00.0' as timestamp)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"FLOAT\", \"TIMESTAMP\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS FLOAT), CAST(2017-12-11 09:30:00.0 AS TIMESTAMP)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 77,
    "fragment" : "IF(true, cast(1 as float), cast('2017-12-11 09:30:00.0' as timestamp))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as float), cast('2017-12-11 09:30:00' as date)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"FLOAT\", \"DATE\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS FLOAT), CAST(2017-12-11 09:30:00 AS DATE)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 70,
    "fragment" : "IF(true, cast(1 as float), cast('2017-12-11 09:30:00' as date))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as double), cast(2 as tinyint)) FROM t
-- !query schema
struct<IF(true, cast(1 as double), cast(2 as tinyint)):double>
-- !query output
1.0


-- !query
SELECT IF(true, cast(1 as double), cast(2 as smallint)) FROM t
-- !query schema
struct<IF(true, cast(1 as double), cast(2 as smallint)):double>
-- !query output
1.0


-- !query
SELECT IF(true, cast(1 as double), cast(2 as int)) FROM t
-- !query schema
struct<IF(true, cast(1 as double), cast(2 as int)):double>
-- !query output
1.0


-- !query
SELECT IF(true, cast(1 as double), cast(2 as bigint)) FROM t
-- !query schema
struct<IF(true, cast(1 as double), cast(2 as bigint)):double>
-- !query output
1.0


-- !query
SELECT IF(true, cast(1 as double), cast(2 as float)) FROM t
-- !query schema
struct<IF(true, cast(1 as double), cast(2 as float)):double>
-- !query output
1.0


-- !query
SELECT IF(true, cast(1 as double), cast(2 as double)) FROM t
-- !query schema
struct<IF(true, cast(1 as double), cast(2 as double)):double>
-- !query output
1.0


-- !query
SELECT IF(true, cast(1 as double), cast(2 as decimal(10, 0))) FROM t
-- !query schema
struct<IF(true, cast(1 as double), cast(2 as decimal(10, 0))):double>
-- !query output
1.0


-- !query
SELECT IF(true, cast(1 as double), cast(2 as string)) FROM t
-- !query schema
struct<IF(true, cast(1 as double), cast(2 as string)):string>
-- !query output
1.0


-- !query
SELECT IF(true, cast(1 as double), cast('2' as binary)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"DOUBLE\", \"BINARY\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS DOUBLE), CAST(2 AS BINARY)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 55,
    "fragment" : "IF(true, cast(1 as double), cast('2' as binary))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as double), cast(2 as boolean)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"DOUBLE\", \"BOOLEAN\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS DOUBLE), CAST(2 AS BOOLEAN)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 54,
    "fragment" : "IF(true, cast(1 as double), cast(2 as boolean))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as double), cast('2017-12-11 09:30:00.0' as timestamp)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"DOUBLE\", \"TIMESTAMP\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS DOUBLE), CAST(2017-12-11 09:30:00.0 AS TIMESTAMP)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 78,
    "fragment" : "IF(true, cast(1 as double), cast('2017-12-11 09:30:00.0' as timestamp))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as double), cast('2017-12-11 09:30:00' as date)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"DOUBLE\", \"DATE\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS DOUBLE), CAST(2017-12-11 09:30:00 AS DATE)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 71,
    "fragment" : "IF(true, cast(1 as double), cast('2017-12-11 09:30:00' as date))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as decimal(10, 0)), cast(2 as tinyint)) FROM t
-- !query schema
struct<IF(true, cast(1 as decimal(10, 0)), cast(2 as tinyint)):decimal(10,0)>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as decimal(10, 0)), cast(2 as smallint)) FROM t
-- !query schema
struct<IF(true, cast(1 as decimal(10, 0)), cast(2 as smallint)):decimal(10,0)>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as decimal(10, 0)), cast(2 as int)) FROM t
-- !query schema
struct<IF(true, cast(1 as decimal(10, 0)), cast(2 as int)):decimal(10,0)>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as decimal(10, 0)), cast(2 as bigint)) FROM t
-- !query schema
struct<IF(true, cast(1 as decimal(10, 0)), cast(2 as bigint)):decimal(20,0)>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as decimal(10, 0)), cast(2 as float)) FROM t
-- !query schema
struct<IF(true, cast(1 as decimal(10, 0)), cast(2 as float)):double>
-- !query output
1.0


-- !query
SELECT IF(true, cast(1 as decimal(10, 0)), cast(2 as double)) FROM t
-- !query schema
struct<IF(true, cast(1 as decimal(10, 0)), cast(2 as double)):double>
-- !query output
1.0


-- !query
SELECT IF(true, cast(1 as decimal(10, 0)), cast(2 as decimal(10, 0))) FROM t
-- !query schema
struct<IF(true, cast(1 as decimal(10, 0)), cast(2 as decimal(10, 0))):decimal(10,0)>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as decimal(10, 0)), cast(2 as string)) FROM t
-- !query schema
struct<IF(true, cast(1 as decimal(10, 0)), cast(2 as string)):string>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as decimal(10, 0)), cast('2' as binary)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"DECIMAL(10,0)\", \"BINARY\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS DECIMAL(10,0)), CAST(2 AS BINARY)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 63,
    "fragment" : "IF(true, cast(1 as decimal(10, 0)), cast('2' as binary))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as decimal(10, 0)), cast(2 as boolean)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"DECIMAL(10,0)\", \"BOOLEAN\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS DECIMAL(10,0)), CAST(2 AS BOOLEAN)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 62,
    "fragment" : "IF(true, cast(1 as decimal(10, 0)), cast(2 as boolean))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as decimal(10, 0)), cast('2017-12-11 09:30:00.0' as timestamp)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"DECIMAL(10,0)\", \"TIMESTAMP\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS DECIMAL(10,0)), CAST(2017-12-11 09:30:00.0 AS TIMESTAMP)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 86,
    "fragment" : "IF(true, cast(1 as decimal(10, 0)), cast('2017-12-11 09:30:00.0' as timestamp))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as decimal(10, 0)), cast('2017-12-11 09:30:00' as date)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"DECIMAL(10,0)\", \"DATE\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS DECIMAL(10,0)), CAST(2017-12-11 09:30:00 AS DATE)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 79,
    "fragment" : "IF(true, cast(1 as decimal(10, 0)), cast('2017-12-11 09:30:00' as date))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as string), cast(2 as tinyint)) FROM t
-- !query schema
struct<IF(true, cast(1 as string), cast(2 as tinyint)):string>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as string), cast(2 as smallint)) FROM t
-- !query schema
struct<IF(true, cast(1 as string), cast(2 as smallint)):string>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as string), cast(2 as int)) FROM t
-- !query schema
struct<IF(true, cast(1 as string), cast(2 as int)):string>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as string), cast(2 as bigint)) FROM t
-- !query schema
struct<IF(true, cast(1 as string), cast(2 as bigint)):string>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as string), cast(2 as float)) FROM t
-- !query schema
struct<IF(true, cast(1 as string), cast(2 as float)):string>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as string), cast(2 as double)) FROM t
-- !query schema
struct<IF(true, cast(1 as string), cast(2 as double)):string>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as string), cast(2 as decimal(10, 0))) FROM t
-- !query schema
struct<IF(true, cast(1 as string), cast(2 as decimal(10, 0))):string>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as string), cast(2 as string)) FROM t
-- !query schema
struct<IF(true, cast(1 as string), cast(2 as string)):string>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as string), cast('2' as binary)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"STRING\", \"BINARY\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS STRING), CAST(2 AS BINARY)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 55,
    "fragment" : "IF(true, cast(1 as string), cast('2' as binary))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as string), cast(2 as boolean)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"STRING\", \"BOOLEAN\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS STRING), CAST(2 AS BOOLEAN)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 54,
    "fragment" : "IF(true, cast(1 as string), cast(2 as boolean))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as string), cast('2017-12-11 09:30:00.0' as timestamp)) FROM t
-- !query schema
struct<IF(true, cast(1 as string), cast('2017-12-11 09:30:00.0' as timestamp)):string>
-- !query output
1


-- !query
SELECT IF(true, cast(1 as string), cast('2017-12-11 09:30:00' as date)) FROM t
-- !query schema
struct<IF(true, cast(1 as string), cast('2017-12-11 09:30:00' as date)):string>
-- !query output
1


-- !query
SELECT IF(true, cast('1' as binary), cast(2 as tinyint)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BINARY\", \"TINYINT\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS BINARY), CAST(2 AS TINYINT)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 56,
    "fragment" : "IF(true, cast('1' as binary), cast(2 as tinyint))"
  } ]
}


-- !query
SELECT IF(true, cast('1' as binary), cast(2 as smallint)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BINARY\", \"SMALLINT\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS BINARY), CAST(2 AS SMALLINT)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 57,
    "fragment" : "IF(true, cast('1' as binary), cast(2 as smallint))"
  } ]
}


-- !query
SELECT IF(true, cast('1' as binary), cast(2 as int)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BINARY\", \"INT\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS BINARY), CAST(2 AS INT)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 52,
    "fragment" : "IF(true, cast('1' as binary), cast(2 as int))"
  } ]
}


-- !query
SELECT IF(true, cast('1' as binary), cast(2 as bigint)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BINARY\", \"BIGINT\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS BINARY), CAST(2 AS BIGINT)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 55,
    "fragment" : "IF(true, cast('1' as binary), cast(2 as bigint))"
  } ]
}


-- !query
SELECT IF(true, cast('1' as binary), cast(2 as float)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BINARY\", \"FLOAT\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS BINARY), CAST(2 AS FLOAT)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 54,
    "fragment" : "IF(true, cast('1' as binary), cast(2 as float))"
  } ]
}


-- !query
SELECT IF(true, cast('1' as binary), cast(2 as double)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BINARY\", \"DOUBLE\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS BINARY), CAST(2 AS DOUBLE)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 55,
    "fragment" : "IF(true, cast('1' as binary), cast(2 as double))"
  } ]
}


-- !query
SELECT IF(true, cast('1' as binary), cast(2 as decimal(10, 0))) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BINARY\", \"DECIMAL(10,0)\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS BINARY), CAST(2 AS DECIMAL(10,0))))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 63,
    "fragment" : "IF(true, cast('1' as binary), cast(2 as decimal(10, 0)))"
  } ]
}


-- !query
SELECT IF(true, cast('1' as binary), cast(2 as string)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BINARY\", \"STRING\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS BINARY), CAST(2 AS STRING)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 55,
    "fragment" : "IF(true, cast('1' as binary), cast(2 as string))"
  } ]
}


-- !query
SELECT IF(true, cast('1' as binary), cast('2' as binary)) FROM t
-- !query schema
struct<IF(true, cast('1' as binary), cast('2' as binary)):binary>
-- !query output
1


-- !query
SELECT IF(true, cast('1' as binary), cast(2 as boolean)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BINARY\", \"BOOLEAN\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS BINARY), CAST(2 AS BOOLEAN)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 56,
    "fragment" : "IF(true, cast('1' as binary), cast(2 as boolean))"
  } ]
}


-- !query
SELECT IF(true, cast('1' as binary), cast('2017-12-11 09:30:00.0' as timestamp)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BINARY\", \"TIMESTAMP\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS BINARY), CAST(2017-12-11 09:30:00.0 AS TIMESTAMP)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 80,
    "fragment" : "IF(true, cast('1' as binary), cast('2017-12-11 09:30:00.0' as timestamp))"
  } ]
}


-- !query
SELECT IF(true, cast('1' as binary), cast('2017-12-11 09:30:00' as date)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BINARY\", \"DATE\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS BINARY), CAST(2017-12-11 09:30:00 AS DATE)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 73,
    "fragment" : "IF(true, cast('1' as binary), cast('2017-12-11 09:30:00' as date))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as boolean), cast(2 as tinyint)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BOOLEAN\", \"TINYINT\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS BOOLEAN), CAST(2 AS TINYINT)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 55,
    "fragment" : "IF(true, cast(1 as boolean), cast(2 as tinyint))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as boolean), cast(2 as smallint)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BOOLEAN\", \"SMALLINT\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS BOOLEAN), CAST(2 AS SMALLINT)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 56,
    "fragment" : "IF(true, cast(1 as boolean), cast(2 as smallint))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as boolean), cast(2 as int)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BOOLEAN\", \"INT\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS BOOLEAN), CAST(2 AS INT)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 51,
    "fragment" : "IF(true, cast(1 as boolean), cast(2 as int))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as boolean), cast(2 as bigint)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BOOLEAN\", \"BIGINT\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS BOOLEAN), CAST(2 AS BIGINT)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 54,
    "fragment" : "IF(true, cast(1 as boolean), cast(2 as bigint))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as boolean), cast(2 as float)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BOOLEAN\", \"FLOAT\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS BOOLEAN), CAST(2 AS FLOAT)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 53,
    "fragment" : "IF(true, cast(1 as boolean), cast(2 as float))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as boolean), cast(2 as double)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BOOLEAN\", \"DOUBLE\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS BOOLEAN), CAST(2 AS DOUBLE)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 54,
    "fragment" : "IF(true, cast(1 as boolean), cast(2 as double))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as boolean), cast(2 as decimal(10, 0))) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BOOLEAN\", \"DECIMAL(10,0)\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS BOOLEAN), CAST(2 AS DECIMAL(10,0))))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 62,
    "fragment" : "IF(true, cast(1 as boolean), cast(2 as decimal(10, 0)))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as boolean), cast(2 as string)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BOOLEAN\", \"STRING\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS BOOLEAN), CAST(2 AS STRING)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 54,
    "fragment" : "IF(true, cast(1 as boolean), cast(2 as string))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as boolean), cast('2' as binary)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BOOLEAN\", \"BINARY\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS BOOLEAN), CAST(2 AS BINARY)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 56,
    "fragment" : "IF(true, cast(1 as boolean), cast('2' as binary))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as boolean), cast(2 as boolean)) FROM t
-- !query schema
struct<IF(true, cast(1 as boolean), cast(2 as boolean)):boolean>
-- !query output
true


-- !query
SELECT IF(true, cast(1 as boolean), cast('2017-12-11 09:30:00.0' as timestamp)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BOOLEAN\", \"TIMESTAMP\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS BOOLEAN), CAST(2017-12-11 09:30:00.0 AS TIMESTAMP)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 79,
    "fragment" : "IF(true, cast(1 as boolean), cast('2017-12-11 09:30:00.0' as timestamp))"
  } ]
}


-- !query
SELECT IF(true, cast(1 as boolean), cast('2017-12-11 09:30:00' as date)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"BOOLEAN\", \"DATE\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(1 AS BOOLEAN), CAST(2017-12-11 09:30:00 AS DATE)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 72,
    "fragment" : "IF(true, cast(1 as boolean), cast('2017-12-11 09:30:00' as date))"
  } ]
}


-- !query
SELECT IF(true, cast('2017-12-12 09:30:00.0' as timestamp), cast(2 as tinyint)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"TIMESTAMP\", \"TINYINT\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(2017-12-12 09:30:00.0 AS TIMESTAMP), CAST(2 AS TINYINT)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 79,
    "fragment" : "IF(true, cast('2017-12-12 09:30:00.0' as timestamp), cast(2 as tinyint))"
  } ]
}


-- !query
SELECT IF(true, cast('2017-12-12 09:30:00.0' as timestamp), cast(2 as smallint)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"TIMESTAMP\", \"SMALLINT\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(2017-12-12 09:30:00.0 AS TIMESTAMP), CAST(2 AS SMALLINT)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 80,
    "fragment" : "IF(true, cast('2017-12-12 09:30:00.0' as timestamp), cast(2 as smallint))"
  } ]
}


-- !query
SELECT IF(true, cast('2017-12-12 09:30:00.0' as timestamp), cast(2 as int)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"TIMESTAMP\", \"INT\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(2017-12-12 09:30:00.0 AS TIMESTAMP), CAST(2 AS INT)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 75,
    "fragment" : "IF(true, cast('2017-12-12 09:30:00.0' as timestamp), cast(2 as int))"
  } ]
}


-- !query
SELECT IF(true, cast('2017-12-12 09:30:00.0' as timestamp), cast(2 as bigint)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"TIMESTAMP\", \"BIGINT\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(2017-12-12 09:30:00.0 AS TIMESTAMP), CAST(2 AS BIGINT)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 78,
    "fragment" : "IF(true, cast('2017-12-12 09:30:00.0' as timestamp), cast(2 as bigint))"
  } ]
}


-- !query
SELECT IF(true, cast('2017-12-12 09:30:00.0' as timestamp), cast(2 as float)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"TIMESTAMP\", \"FLOAT\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(2017-12-12 09:30:00.0 AS TIMESTAMP), CAST(2 AS FLOAT)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 77,
    "fragment" : "IF(true, cast('2017-12-12 09:30:00.0' as timestamp), cast(2 as float))"
  } ]
}


-- !query
SELECT IF(true, cast('2017-12-12 09:30:00.0' as timestamp), cast(2 as double)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"TIMESTAMP\", \"DOUBLE\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(2017-12-12 09:30:00.0 AS TIMESTAMP), CAST(2 AS DOUBLE)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 78,
    "fragment" : "IF(true, cast('2017-12-12 09:30:00.0' as timestamp), cast(2 as double))"
  } ]
}


-- !query
SELECT IF(true, cast('2017-12-12 09:30:00.0' as timestamp), cast(2 as decimal(10, 0))) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"TIMESTAMP\", \"DECIMAL(10,0)\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(2017-12-12 09:30:00.0 AS TIMESTAMP), CAST(2 AS DECIMAL(10,0))))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 86,
    "fragment" : "IF(true, cast('2017-12-12 09:30:00.0' as timestamp), cast(2 as decimal(10, 0)))"
  } ]
}


-- !query
SELECT IF(true, cast('2017-12-12 09:30:00.0' as timestamp), cast(2 as string)) FROM t
-- !query schema
struct<IF(true, cast('2017-12-12 09:30:00.0' as timestamp), cast(2 as string)):string>
-- !query output
2017-12-12 09:30:00


-- !query
SELECT IF(true, cast('2017-12-12 09:30:00.0' as timestamp), cast('2' as binary)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"TIMESTAMP\", \"BINARY\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(2017-12-12 09:30:00.0 AS TIMESTAMP), CAST(2 AS BINARY)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 80,
    "fragment" : "IF(true, cast('2017-12-12 09:30:00.0' as timestamp), cast('2' as binary))"
  } ]
}


-- !query
SELECT IF(true, cast('2017-12-12 09:30:00.0' as timestamp), cast(2 as boolean)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"TIMESTAMP\", \"BOOLEAN\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(2017-12-12 09:30:00.0 AS TIMESTAMP), CAST(2 AS BOOLEAN)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 79,
    "fragment" : "IF(true, cast('2017-12-12 09:30:00.0' as timestamp), cast(2 as boolean))"
  } ]
}


-- !query
SELECT IF(true, cast('2017-12-12 09:30:00.0' as timestamp), cast('2017-12-11 09:30:00.0' as timestamp)) FROM t
-- !query schema
struct<IF(true, cast('2017-12-12 09:30:00.0' as timestamp), cast('2017-12-11 09:30:00.0' as timestamp)):timestamp>
-- !query output
2017-12-12 09:30:00


-- !query
SELECT IF(true, cast('2017-12-12 09:30:00.0' as timestamp), cast('2017-12-11 09:30:00' as date)) FROM t
-- !query schema
struct<IF(true, cast('2017-12-12 09:30:00.0' as timestamp), cast('2017-12-11 09:30:00' as date)):timestamp>
-- !query output
2017-12-12 09:30:00


-- !query
SELECT IF(true, cast('2017-12-12 09:30:00' as date), cast(2 as tinyint)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"DATE\", \"TINYINT\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(2017-12-12 09:30:00 AS DATE), CAST(2 AS TINYINT)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 72,
    "fragment" : "IF(true, cast('2017-12-12 09:30:00' as date), cast(2 as tinyint))"
  } ]
}


-- !query
SELECT IF(true, cast('2017-12-12 09:30:00' as date), cast(2 as smallint)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"DATE\", \"SMALLINT\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(2017-12-12 09:30:00 AS DATE), CAST(2 AS SMALLINT)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 73,
    "fragment" : "IF(true, cast('2017-12-12 09:30:00' as date), cast(2 as smallint))"
  } ]
}


-- !query
SELECT IF(true, cast('2017-12-12 09:30:00' as date), cast(2 as int)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"DATE\", \"INT\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(2017-12-12 09:30:00 AS DATE), CAST(2 AS INT)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 68,
    "fragment" : "IF(true, cast('2017-12-12 09:30:00' as date), cast(2 as int))"
  } ]
}


-- !query
SELECT IF(true, cast('2017-12-12 09:30:00' as date), cast(2 as bigint)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"DATE\", \"BIGINT\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(2017-12-12 09:30:00 AS DATE), CAST(2 AS BIGINT)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 71,
    "fragment" : "IF(true, cast('2017-12-12 09:30:00' as date), cast(2 as bigint))"
  } ]
}


-- !query
SELECT IF(true, cast('2017-12-12 09:30:00' as date), cast(2 as float)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"DATE\", \"FLOAT\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(2017-12-12 09:30:00 AS DATE), CAST(2 AS FLOAT)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 70,
    "fragment" : "IF(true, cast('2017-12-12 09:30:00' as date), cast(2 as float))"
  } ]
}


-- !query
SELECT IF(true, cast('2017-12-12 09:30:00' as date), cast(2 as double)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"DATE\", \"DOUBLE\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(2017-12-12 09:30:00 AS DATE), CAST(2 AS DOUBLE)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 71,
    "fragment" : "IF(true, cast('2017-12-12 09:30:00' as date), cast(2 as double))"
  } ]
}


-- !query
SELECT IF(true, cast('2017-12-12 09:30:00' as date), cast(2 as decimal(10, 0))) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"DATE\", \"DECIMAL(10,0)\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(2017-12-12 09:30:00 AS DATE), CAST(2 AS DECIMAL(10,0))))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 79,
    "fragment" : "IF(true, cast('2017-12-12 09:30:00' as date), cast(2 as decimal(10, 0)))"
  } ]
}


-- !query
SELECT IF(true, cast('2017-12-12 09:30:00' as date), cast(2 as string)) FROM t
-- !query schema
struct<IF(true, cast('2017-12-12 09:30:00' as date), cast(2 as string)):string>
-- !query output
2017-12-12


-- !query
SELECT IF(true, cast('2017-12-12 09:30:00' as date), cast('2' as binary)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"DATE\", \"BINARY\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(2017-12-12 09:30:00 AS DATE), CAST(2 AS BINARY)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 73,
    "fragment" : "IF(true, cast('2017-12-12 09:30:00' as date), cast('2' as binary))"
  } ]
}


-- !query
SELECT IF(true, cast('2017-12-12 09:30:00' as date), cast(2 as boolean)) FROM t
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{
  "errorClass" : "DATATYPE_MISMATCH.DATA_DIFF_TYPES",
  "sqlState" : "42K09",
  "messageParameters" : {
    "dataType" : "[\"DATE\", \"BOOLEAN\"]",
    "functionName" : "`if`",
    "sqlExpr" : "\"(IF(true, CAST(2017-12-12 09:30:00 AS DATE), CAST(2 AS BOOLEAN)))\""
  },
  "queryContext" : [ {
    "objectType" : "",
    "objectName" : "",
    "startIndex" : 8,
    "stopIndex" : 72,
    "fragment" : "IF(true, cast('2017-12-12 09:30:00' as date), cast(2 as boolean))"
  } ]
}


-- !query
SELECT IF(true, cast('2017-12-12 09:30:00' as date), cast('2017-12-11 09:30:00.0' as timestamp)) FROM t
-- !query schema
struct<IF(true, cast('2017-12-12 09:30:00' as date), cast('2017-12-11 09:30:00.0' as timestamp)):timestamp>
-- !query output
2017-12-12 00:00:00


-- !query
SELECT IF(true, cast('2017-12-12 09:30:00' as date), cast('2017-12-11 09:30:00' as date)) FROM t
-- !query schema
struct<IF(true, cast('2017-12-12 09:30:00' as date), cast('2017-12-11 09:30:00' as date)):date>
-- !query output
2017-12-12
