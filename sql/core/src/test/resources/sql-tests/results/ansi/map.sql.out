-- Automatically generated by SQLQueryTestSuite
-- !query
select element_at(map(1, 'a', 2, 'b'), 5)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkNoSuchElementException
{"errorClass":"MAP_KEY_DOES_NOT_EXIST","messageParameters":["5","\"spark.sql.ansi.enabled\""],"queryContext":[{"objectType":"","objectName":"","startIndex":7,"stopIndex":40,"fragment":"element_at(map(1, 'a', 2, 'b'), 5"}]}


-- !query
select map(1, 'a', 2, 'b')[5]
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkNoSuchElementException
{"errorClass":"MAP_KEY_DOES_NOT_EXIST","messageParameters":["5","\"spark.sql.ansi.enabled\""],"queryContext":[{"objectType":"","objectName":"","startIndex":7,"stopIndex":28,"fragment":"map(1, 'a', 2, 'b')[5"}]}


-- !query
select map_contains_key(map(1, 'a', 2, 'b'), 5)
-- !query schema
struct<map_contains_key(map(1, a, 2, b), 5):boolean>
-- !query output
false


-- !query
select map_contains_key(map(1, 'a', 2, 'b'), 1)
-- !query schema
struct<map_contains_key(map(1, a, 2, b), 1):boolean>
-- !query output
true


-- !query
select map_contains_key(map(1, 'a', 2, 'b'), 5.0)
-- !query schema
struct<map_contains_key(map(1, a, 2, b), 5.0):boolean>
-- !query output
false


-- !query
select map_contains_key(map(1, 'a', 2, 'b'), 1.0)
-- !query schema
struct<map_contains_key(map(1, a, 2, b), 1.0):boolean>
-- !query output
true


-- !query
select map_contains_key(map(1.0, 'a', 2, 'b'), 5)
-- !query schema
struct<map_contains_key(map(1.0, a, 2, b), 5):boolean>
-- !query output
false


-- !query
select map_contains_key(map(1.0, 'a', 2, 'b'), 1)
-- !query schema
struct<map_contains_key(map(1.0, a, 2, b), 1):boolean>
-- !query output
true


-- !query
select map_contains_key(map('1', 'a', '2', 'b'), 1)
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{"errorClass":null,"messageParameters":[],"queryContext":[]}


-- !query
select map_contains_key(map(1, 'a', 2, 'b'), '1')
-- !query schema
struct<>
-- !query output
org.apache.spark.sql.AnalysisException
{"errorClass":null,"messageParameters":[],"queryContext":[]}


-- !query
set spark.sql.ansi.strictIndexOperator=false
-- !query schema
struct<key:string,value:string>
-- !query output
spark.sql.ansi.strictIndexOperator	false


-- !query
select map(1, 'a', 2, 'b')[5]
-- !query schema
struct<map(1, a, 2, b)[5]:string>
-- !query output
NULL


-- !query
select element_at(map(1, 'a', 2, 'b'), 5)
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkNoSuchElementException
{"errorClass":"MAP_KEY_DOES_NOT_EXIST","messageParameters":["5","\"spark.sql.ansi.enabled\""],"queryContext":[{"objectType":"","objectName":"","startIndex":7,"stopIndex":40,"fragment":"element_at(map(1, 'a', 2, 'b'), 5"}]}


-- !query
select element_at(map('a', 1, 'b', 2), 'c')
-- !query schema
struct<>
-- !query output
org.apache.spark.SparkNoSuchElementException
{"errorClass":"MAP_KEY_DOES_NOT_EXIST","messageParameters":["'c'","\"spark.sql.ansi.enabled\""],"queryContext":[{"objectType":"","objectName":"","startIndex":7,"stopIndex":42,"fragment":"element_at(map('a', 1, 'b', 2), 'c'"}]}
